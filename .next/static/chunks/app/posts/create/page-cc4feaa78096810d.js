(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[697],{6109:function(e,t,a){Promise.resolve().then(a.bind(a,266))},4793:function(e,t,a){"use strict";a.d(t,{I8:function(){return c},Vv:function(){return d},db:function(){return o},tO:function(){return u}});var r=a(6142),n=a(8121),s=a(7065),l=a(4905);let i=0===(0,r.C6)().length?(0,r.ZF)({apiKey:"AIzaSyAQX3H-PUEj1AUyO-X8vmBdArveo3UMNi8",authDomain:"intracker-base.firebaseapp.com",projectId:"intracker-base",storageBucket:"intracker-base.appspot.com",messagingSenderId:"633294640208",appId:"1:633294640208:web:245dc200e69fbce08b6d55",measurementId:"G-TZM9SKR1RY"}):(0,r.C6)()[0],o=(0,n.ad)(i),c=(0,s.v0)(i),u=(0,l.cF)(i),d=new s.hJ},4329:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var r=a(7437),n=a(8792),s=a(2265),l=a(3782),i=a(7907);function o(){let[e,t]=(0,s.useState)(""),a=(0,i.usePathname)();return(0,s.useEffect)(()=>{let e=localStorage.getItem("user");e&&t(JSON.parse(e).displayName)},[]),(0,r.jsx)("div",{children:(0,r.jsxs)("nav",{className:"w-full py-4 border-b-2 px-8 text-center flex items-center justify-between sticky top-0 bg-[#f5f7ff]",children:[(0,r.jsxs)(n.default,{href:"/",className:"text-2xl font-bold",children:["XpostShare"," "]}),e?(0,r.jsxs)("div",{className:"flex items-center gap-5",children:[(0,r.jsx)("p",{className:"text-sm font-semibold",children:e}),"/posts/create"!==a&&(0,r.jsx)(n.default,{href:"/posts/create",className:"underline text-blue-500",children:"Create Post"}),(0,r.jsx)("button",{className:"bg-red-500 text-white px-6 py-3 rounded-md",onClick:l.N,children:"Log Out"})]}):(0,r.jsx)(n.default,{href:"/login",className:"bg-blue-500 hover:bg-blue-700 text-white px-8 py-3 rounded-md",children:"Sign in"})]})})}},266:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var r=a(7437),n=a(7065),s=a(2265),l=a(7907),i=a(4329),o=a(8121),c=a(4793),u=a(3782),d=a(4905);let m="../../../../public/OIP.jfif";function p(){let[e,t]=(0,s.useState)({}),[a,p]=(0,s.useState)(m),[f,g]=(0,s.useState)(""),[h,b]=(0,s.useState)(""),[x,N]=(0,s.useState)(!1),j=(0,l.useRouter)();(0,s.useEffect)(()=>{(0,n.Aj)(c.I8,e=>{e?t(e):j.back()})},[j]);let y=async t=>{t.preventDefault(),N(!0);let r=await (0,o.ET)((0,o.hJ)(c.db,"posts"),{author_id:e.uid,title:h,content:f,author_name:e.displayName,pub_date:(0,u.Ux)(),slug:(0,u.Gq)(h),comments:[]});if(a!==m){let e=(0,d.iH)(c.tO,"posts/".concat(r.id,"/image"));await (0,d.sf)(e,a,"data_url").then(async()=>{let t=await (0,d.Jt)(e);await (0,o.r7)((0,o.JU)(c.db,"posts",r.id),{image_url:t})})}N(!1),alert("Post created successfully!"),j.push("/")};return(0,r.jsxs)("div",{children:[(0,r.jsx)(i.Z,{}),(0,r.jsx)("main",{className:"md:px-8 py-8 px-4 w-full",children:(0,r.jsxs)("form",{className:"flex flex-col w-full",onSubmit:y,children:[(0,r.jsx)("label",{htmlFor:"title",className:"text-sm text-blue-600",children:"Title"}),(0,r.jsx)("input",{type:"text",name:"title",id:"title",value:h,required:!0,onChange:e=>b(e.target.value),className:" px-4 py-3 border-2 rounded-md text-lg mb-4"}),(0,r.jsx)("label",{htmlFor:"content",className:"text-sm text-blue-600",children:"Content"}),(0,r.jsx)("textarea",{name:"content",rows:15,value:f,required:!0,onChange:e=>g(e.target.value),id:"content",className:" px-4 py-3 border-2 rounded-md mb-4"}),(0,r.jsx)("label",{htmlFor:"upload",className:"text-sm text-blue-600",children:"Upload Cover Photo"}),(0,r.jsx)("input",{type:"file",name:"upload",id:"upload",onChange:e=>{let t=new FileReader;e.target.files&&e.target.files[0]?(t.readAsDataURL(e.target.files[0]),t.onload=e=>{e.target&&e.target.result&&p(e.target.result)}):p(m)},className:" px-4 py-3 border-2 rounded-md mb-4",accept:"image/jpeg, image/png, image/jpg, image/webp, image/jfif,image/gif, image/svg, image/tiff, image/bmp"}),(0,r.jsx)("button",{type:"submit",className:"bg-blue-600 mt-4 text-white py-4 rounded-md",disabled:x,children:x?"Creating post...":"Create Post"})]})})]})}},3782:function(e,t,a){"use strict";a.d(t,{Gq:function(){return o},Hh:function(){return c},N:function(){return l},Ux:function(){return i},VQ:function(){return s}});var r=a(7065),n=a(4793);let s=(e,t)=>{(0,r.rh)(n.I8,e).then(e=>{let a=t.credentialFromResult(e);if(null==a?void 0:a.accessToken){let t=e.user;console.log({displayName:t.displayName,u_id:t.uid}),localStorage.setItem("user",JSON.stringify({displayName:t.displayName,u_id:t.uid})),window.location.replace("/")}}).catch(e=>{alert("Refresh page! An error occurred while signing out - ".concat(e.message))})},l=()=>{(0,r.w7)(n.I8).then(()=>{localStorage.removeItem("user"),window.location.replace("/")}).catch(e=>{alert("Refresh page! An error occurred while signing out - ".concat(e.message))})},i=()=>{let e=new Date,t=e.getDate(),a=e.getMonth(),r=e.getFullYear(),n=["th","st","nd","rd"][(t-1)%10>3?0:(t-1)%10],s=["Jan.","Feb.","Mar.","Apr.","May","Jun.","Jul.","Aug.","Sept.","Oct.","Nov.","Dec."][a];return"".concat(t).concat(n," ").concat(s," ").concat(r)},o=e=>{let t=e.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-"),a=Array.from({length:5},()=>String.fromCharCode(97+Math.floor(26*Math.random()))).join("");return"".concat(t,"-").concat(a)},c=e=>e.split("/").slice(2).join("/")}},function(e){e.O(0,[358,863,636,901,971,69,744],function(){return e(e.s=6109)}),_N_E=e.O()}]);